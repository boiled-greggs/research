# Greg Stewart 2017

from __future__ import print_function
from pythtb import *
import numpy as np
import pylab as plt

lat = [[20.4669990540, 0.0000000000, 0.0000000000], \
	[-10.2334995270, 17.7249411200, 0.0000000000], \
	[0.0000000000, 0.0000000000, 27.1919994354]]

orb = [[0.036983572, 1.520981788, 2.803188866], \
	[1.313961304, 0.782990606, 6.143414021], \
	[0.033998789, 0.040999508, 2.769186540], \
	[0.033998796, 0.039999521, 6.178416159], \
	[2.592923706, 1.522981721, 2.663179506], \
	[3.872901203, 0.790990538, 6.047407337], \
	[2.590939114, 0.042999487, 2.653178750], \
	[2.592938846, 0.045999449, 6.065408413], \
	[5.150864293, 1.522981721, 2.597174885], \
	[6.428841413, 0.790990538, 6.047407337], \
	[5.150879154, 0.043999470, 2.601175349], \
	[5.150879078, 0.049999402, 6.014404824], \
	[7.708804271, 1.522981721, 2.663179506], \
	[8.986782725, 0.782990606, 6.143414021], \
	[7.709819787, 0.042999487, 2.653178750], \
	[7.708819715, 0.045999449, 6.065408413], \
	[10.264744786, 1.520981788, 2.803188866], \
	[11.544721863, 0.777990641, 6.255421347], \
	[10.267759181, 0.040999508, 2.769186540], \
	[10.266760376, 0.039999521, 6.178416159], \
	[12.822684534, 1.515981823, 2.914196379], \
	[14.103663097, 0.776990674, 6.335426580], \
	[12.825700452, 0.034999580, 2.881194069], \
	[12.824699477, 0.036999555, 6.293423934], \
	[15.383624620, 1.512981923, 2.956199228], \
	[16.664603487, 0.776990674, 6.335426580], \
	[15.383639869, 0.030999627, 2.932197456], \
	[15.383640405, 0.036999555, 6.345427133], \
	[17.944565316, 1.515981823, 2.914196379], \
	[19.223544111, 0.777990641, 6.255421347], \
	[17.942580748, 0.034999580, 2.881194069], \
	[17.943580455, 0.036999555, 6.293423934], \
	[-1.235009418, 3.739955101, 2.899195145], \
	[0.037968436, 2.996964019, 6.283423382], \
	[-1.239994202, 2.258973036, 2.881194069], \
	[-1.241994036, 2.256972838, 6.293423934], \
	[1.319930908, 3.742955001, 2.763186047], \
	[2.597908638, 3.005963984, 6.184416653], \
	[1.315946165, 2.262972902, 2.740184492], \
	[1.316946201, 2.261972936, 6.206417788], \
	[3.873871198, 3.741955298, 2.644178212], \
	[5.150848434, 3.027963779, 6.071408907], \
	[3.871886375, 2.261972936, 2.611175902], \
	[3.873886600, 2.274972767, 6.089410388], \
	[6.427811641, 3.741955298, 2.644178212], \
	[7.703789451, 3.005963984, 6.184416653], \
	[6.429826353, 2.261972936, 2.611175902], \
	[6.426826702, 2.274972767, 6.089410388], \
	[8.980752200, 3.742955001, 2.763186047], \
	[10.262729617, 2.996964019, 6.283423382], \
	[8.985767172, 2.262972902, 2.740184492], \
	[8.983766795, 2.261972936, 6.206417788], \
	[11.536691800, 3.739955101, 2.899195145], \
	[12.823670618, 2.994964086, 6.335426580], \
	[11.541707078, 2.258973036, 2.881194069], \
	[11.543707302, 2.256972838, 6.293423934], \
	[14.101632793, 3.734955003, 2.956199228], \
	[15.383609447, 2.994964086, 6.354428076], \
	[14.102647468, 2.254973169, 2.953198981], \
	[14.103647809, 2.254973169, 6.345427133], \
	[16.666572108, 3.734955003, 2.956199228], \
	[17.944549838, 2.994964086, 6.335426580], \
	[16.665587321, 2.254973169, 2.953198981], \
	[16.664588200, 2.254973169, 6.345427133], \
	[-2.513002092, 5.953928316, 2.899195145], \
	[-1.241024274, 5.212937168, 6.349427597], \
	[-2.515986923, 4.475945887, 2.932197456], \
	[-2.521987006, 4.472946515, 6.345427133], \
	[0.062937621, 5.964928477, 2.875193575], \
	[1.318915623, 5.216937563, 6.302424472], \
	[0.048952974, 4.483946148, 2.857192499], \
	[0.038953223, 4.474946448, 6.336426595], \
	[2.634877495, 5.938928816, 3.016203153], \
	[3.841856470, 5.241937258, 5.931399547], \
	[2.599893308, 4.482946182, 2.738184259], \
	[2.597893541, 4.483946148, 6.208418223], \
	[5.150819309, 5.881929659, 3.252219197], \
	[6.459795566, 5.241937258, 5.931399547], \
	[5.150834253, 4.483946148, 2.732184171], \
	[5.150833643, 4.520945443, 5.980402701], \
	[7.666759902, 5.938928816, 3.016203153], \
	[8.981737292, 5.216937563, 6.302424472], \
	[7.700774856, 4.482946182, 2.738184259], \
	[7.703774354, 4.483946148, 6.208418223], \
	[10.238700691, 5.964928477, 2.875193575], \
	[11.541676427, 5.212937168, 6.349427597], \
	[10.251715190, 4.483946148, 2.857192499], \
	[10.261714027, 4.474946448, 6.336426595], \
	[12.814638879, 5.953928316, 2.899195145], \
	[14.103617464, 5.211937201, 6.335426580], \
	[12.817655152, 4.475945887, 2.932197456], \
	[12.822655027, 4.472946515, 6.345427133], \
	[15.383579864, 5.951928911, 2.914196379], \
	[16.664557854, 5.211937201, 6.335426580], \
	[15.383595113, 4.473946482, 2.953198981], \
	[15.383594198, 4.472946515, 6.345427133], \
	[-3.799994862, 8.164902159, 2.803188866], \
	[-2.520017137, 7.427910878, 6.283423382], \
	[-3.798979644, 6.689919630, 2.881194069], \
	[-3.801979595, 6.689919630, 6.293423934], \
	[-1.233054941, 8.165902654, 2.763186047], \
	[0.041923138, 7.427910878, 6.302424472], \
	[-1.227039780, 6.693919497, 2.857192499], \
	[-1.240039335, 6.689919630, 6.336426595], \
	[1.325885073, 8.205901849, 3.016203153], \
	[2.534865035, 7.392911516, 5.694383487], \
	[1.355899271, 6.711919425, 2.966199781], \
	[1.323900250, 6.693919497, 6.214418716], \
	[3.846844146, 6.427923081, 3.737251681], \
	[3.658847415, 6.536921561, 5.209350801], \
	[7.766742474, 7.392911516, 5.694383487], \
	[6.453783150, 6.427923081, 3.737251681], \
	[6.642778393, 6.536921561, 5.209350801], \
	[8.975706577, 8.205901849, 3.016203153], \
	[10.258683725, 7.427910878, 6.302424472], \
	[8.944722535, 6.711919425, 2.966199781], \
	[8.976722167, 6.693919497, 6.214418716], \
	[11.533647469, 8.165902654, 2.763186047], \
	[12.820624457, 7.427910878, 6.283423382], \
	[11.528661928, 6.693919497, 2.857192499], \
	[11.540662362, 6.689919630, 6.336426595], \
	[14.100586857, 8.164902159, 2.803188866], \
	[15.383564310, 7.427910878, 6.255421347], \
	[14.099602070, 6.689919630, 2.881194069], \
	[14.102601873, 6.689919630, 6.293423934], \
	[-5.082987717, 10.377875936, 2.691181337], \
	[-3.800009883, 9.640884126, 6.143414021], \
	[-5.082972444, 8.902892879, 2.769186540], \
	[-5.082972444, 8.902892879, 6.178416159], \
	[-2.520047482, 10.377875936, 2.663179506], \
	[-1.233069885, 9.639884688, 6.184416653], \
	[-2.518032161, 8.901893440, 2.740184492], \
	[-2.518032161, 8.903893374, 6.206417788], \
	[0.041892945, 10.377875936, 2.644178212], \
	[1.325871044, 9.599884965, 5.931399547], \
	[0.047907801, 8.903893374, 2.738184259], \
	[0.047907801, 8.901893440, 6.208418223], \
	[2.534834537, 10.412875297, 3.252219197], \
	[2.354853039, 9.011891887, 3.737251681], \
	[2.354855174, 8.793894399, 5.209350801], \
	[7.766712585, 10.412875297, 3.252219197], \
	[8.975692548, 9.599884965, 5.931399547], \
	[7.945721801, 9.011891887, 3.737251681], \
	[7.945723936, 8.793894399, 5.209350801], \
	[10.258653837, 10.377875936, 2.644178212], \
	[11.533632525, 9.639884688, 6.184416653], \
	[10.253668600, 8.903893374, 2.738184259], \
	[10.253669210, 8.901893440, 6.208418223], \
	[12.820594569, 10.377875936, 2.663179506], \
	[14.100571303, 9.640884126, 6.143414021], \
	[12.818609745, 8.901893440, 2.740184492], \
	[12.818609135, 8.903893374, 6.206417788], \
	[-6.363979965, 12.593848556, 2.612175916], \
	[-5.083002432, 11.853857375, 6.032406305], \
	[-6.363965145, 11.115867184, 2.653178750], \
	[-6.366965334, 11.115867184, 6.065408413], \
	[-3.802039843, 12.593848556, 2.612175916], \
	[-2.513062783, 11.851858498, 6.047407337], \
	[-3.802025204, 11.115867184, 2.653178750], \
	[-3.799025096, 11.115867184, 6.065408413], \
	[-1.241100062, 12.592849118, 2.597174885], \
	[0.062877540, 11.840857280, 6.071408907], \
	[-1.240085082, 11.115867184, 2.611175902], \
	[-1.227084917, 11.111867317, 6.089410388], \
	[1.318840597, 12.589848689, 2.644178212], \
	[2.634816803, 11.866857470, 5.931399547], \
	[1.323855112, 11.111867317, 2.732184171], \
	[1.355854439, 11.093866860, 5.980402701], \
	[3.841782054, 12.563849556, 3.016203153], \
	[5.150757092, 11.923857155, 5.694383487], \
	[3.658798923, 11.268864725, 3.737251681], \
	[3.846794129, 11.378863171, 5.209350801], \
	[6.459719931, 12.563849556, 3.016203153], \
	[7.666699211, 11.866857470, 5.931399547], \
	[6.642729901, 11.268864725, 3.737251681], \
	[6.453733133, 11.378863171, 5.209350801], \
	[8.981662267, 12.589848689, 2.644178212], \
	[10.238639694, 11.840857280, 6.071408907], \
	[8.976676420, 11.111867317, 2.732184171], \
	[8.944677703, 11.093866860, 5.980402701], \
	[11.541601096, 12.592849118, 2.597174885], \
	[12.814578493, 11.851858498, 6.047407337], \
	[11.540616614, 11.115867184, 2.611175902], \
	[11.528617400, 11.111867317, 6.089410388], \
	[-7.643972787, 14.810821671, 2.612175916], \
	[-6.365995591, 14.070831547, 5.990403254], \
	[-7.643957972, 13.332840299, 2.601175349], \
	[-7.649957726, 13.329839871, 6.014404824], \
	[-5.083032778, 14.810821671, 2.592174608], \
	[-3.800055325, 14.070831547, 5.990403254], \
	[-5.083017834, 13.332840299, 2.601175349], \
	[-5.083017834, 13.331839804, 5.993403703], \
	[-2.522092387, 14.810821671, 2.612175916], \
	[-1.235115094, 14.065831185, 6.047407337], \
	[-2.522077748, 13.332840299, 2.601175349], \
	[-2.516077531, 13.329839871, 6.014404824], \
	[0.037847053, 14.808822794, 2.663179506], \
	[1.319825689, 14.062830757, 6.184416653], \
	[0.038862643, 13.330840365, 2.611175902], \
	[0.048862394, 13.321840137, 6.089410388], \
	[2.597787712, 14.799822566, 2.763186047], \
	[3.873766132, 14.063831252, 6.302424472], \
	[2.597802961, 13.321840137, 2.738184259], \
	[2.599803034, 13.322840632, 6.208418223], \
	[5.150729034, 14.777822243, 2.875193575], \
	[6.427706575, 14.063831252, 6.302424472], \
	[5.150743673, 13.284840842, 2.966199781], \
	[5.150743063, 13.321840137, 6.214418716], \
	[7.703669135, 14.799822566, 2.763186047], \
	[8.980646066, 14.062830757, 6.184416653], \
	[7.702684043, 13.321840137, 2.738184259], \
	[7.700683971, 13.322840632, 6.208418223], \
	[10.262608234, 14.808822794, 2.663179506], \
	[11.536585971, 14.065831185, 6.047407337], \
	[10.261624362, 13.330840365, 2.611175902], \
	[10.252624341, 13.321840137, 6.089410388], \
	[-8.921965918, 17.027795843, 2.691181337], \
	[-7.643988265, 16.289805652, 6.032406305], \
	[-8.923950251, 15.548812919, 2.653178750], \
	[-8.924950554, 15.546812986, 6.065408413], \
	[-6.363025676, 17.028795281, 2.612175916], \
	[-5.083048332, 16.292803967, 5.990403254], \
	[-6.363010427, 15.550812852, 2.601175349], \
	[-6.364010158, 15.550812852, 5.993403703], \
	[-3.803085322, 17.028795281, 2.612175916], \
	[-2.522108246, 16.289805652, 6.032406305], \
	[-3.803070072, 15.550812852, 2.601175349], \
	[-3.802070341, 15.550812852, 5.993403703], \
	[-1.244145003, 17.027795843, 2.691181337], \
	[0.036832682, 16.284804234, 6.143414021], \
	[-1.242129682, 15.548812919, 2.653178750], \
	[-1.240129609, 15.546812986, 6.065408413], \
	[1.313795584, 17.022796538, 2.803188866], \
	[2.592772587, 16.282805357, 6.283423382], \
	[1.316810027, 15.543813614, 2.740184492], \
	[1.315809686, 15.542814176, 6.206417788], \
	[3.872734683, 17.014795748, 2.899195145], \
	[5.150713175, 16.282805357, 6.349427597], \
	[3.873750883, 15.530813519, 2.857192499], \
	[3.871750811, 15.543813614, 6.336426595], \
	[6.428675808, 17.014795748, 2.899195145], \
	[7.708653762, 16.282805357, 6.283423382], \
	[6.426690985, 15.530813519, 2.857192499], \
	[6.429690178, 15.543813614, 6.336426595], \
	[8.986615785, 17.022796538, 2.803188866], \
	[10.264593667, 16.284804234, 6.143414021], \
	[8.983630621, 15.543813614, 2.740184492], \
	[8.985631303, 15.542814176, 6.206417788]]

my_model = tb_model(3, 3, lat, orb)

# set model parameters
delta = 0.0
t = -1.0

my_model.set_onsite([delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta, delta, delta, \
	delta, delta, delta])

# set hopping parameters for connected orbitals
# (amplitude, i, j, [lattice vector to cell containing j])

my_model.display()

path = [ [0., 0., 0.5], [2./3., 1./3., 0.5], [0.5, 0.5, 0.5], [0., 0., 0.5] ]
label = (r'$\Gamma $',r'$K$', r'$M$', r'$\Gamma $')

nk = 800

(k_vec, k_dist, k_node) = my_model.k_path(path, nk)

print('-'*20)
print('starting calculation')
print('-'*20)
print('Calculating bands . . .')

evals = my_model.solve_all(k_vec)

fig, ax = plt.subplots()

ax.set_xlim([0, k_node[-1]])
ax.set_xticks(k_node)
ax.set_xticklabels(label)

for n in range(len(k_node)):
	ax.axvline(x=k_node[n], linewidth=0.5, color='k')

ax.set_title('GrapheneHschwartzite band structure')
ax.set_xlabel('Path in k-space')
ax.set_ylabel('Band energy')

ax.plot(k_dist, evals[0])
ax.plot(k_dist, evals[1])

fig.tight_layout()
fig.savefig('GrapheneH.pdf')

print('Done.')